<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Energy-Based Modeling library for PyTorch, offering tools for sampling, inference, and learning in complex distributions."><meta name=author content="Soran Ghaderi"><link href=https://soran-ghaderi.github.io/torchebm/0.1.37/blog/hamiltonian-mechanics/ rel=canonical><link href=../langevin-dynamics-sampling/ rel=prev><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.11"><title>Hamiltonian Mechanics - TorchEBM</title><link rel=stylesheet href=../../assets/stylesheets/main.4af4bdda.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=deep-orange data-md-color-accent=deep-orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#hamiltonian-mechanics class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=TorchEBM class="md-header__button md-logo" aria-label=TorchEBM data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12.005 0 4.952 7.053a9.865 9.865 0 0 0 0 14.022 9.866 9.866 0 0 0 14.022 0c3.984-3.9 3.986-10.205.085-14.023l-1.744 1.743c2.904 2.905 2.904 7.634 0 10.538s-7.634 2.904-10.538 0-2.904-7.634 0-10.538l4.647-4.646.582-.665zm3.568 3.899a1.327 1.327 0 0 0-1.327 1.327 1.327 1.327 0 0 0 1.327 1.328A1.327 1.327 0 0 0 16.9 5.226 1.327 1.327 0 0 0 15.573 3.9z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> TorchEBM </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Hamiltonian Mechanics </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-orange data-md-color-accent=deep-orange aria-label="Light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=green aria-label="deep orange" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="deep orange" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/soran-ghaderi/torchebm/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> torchebm </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../api/ class=md-tabs__link> API Reference </a> </li> <li class=md-tabs__item> <a href=../../developer_guide/api_generation/ class=md-tabs__link> Developer Guide </a> </li> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=TorchEBM class="md-nav__button md-logo" aria-label=TorchEBM data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12.005 0 4.952 7.053a9.865 9.865 0 0 0 0 14.022 9.866 9.866 0 0 0 14.022 0c3.984-3.9 3.986-10.205.085-14.023l-1.744 1.743c2.904 2.905 2.904 7.634 0 10.538s-7.634 2.904-10.538 0-2.904-7.634 0-10.538l4.647-4.646.582-.665zm3.568 3.899a1.327 1.327 0 0 0-1.327 1.327 1.327 1.327 0 0 0 1.327 1.328A1.327 1.327 0 0 0 16.9 5.226 1.327 1.327 0 0 0 15.573 3.9z"/></svg> </a> TorchEBM </label> <div class=md-nav__source> <a href=https://github.com/soran-ghaderi/torchebm/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> torchebm </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../api/ class="md-nav__link "> <span class=md-ellipsis> API Reference </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> <span class=md-ellipsis> Basesampler </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Basesampler </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/basesampler/classes/BaseSampler/ class=md-nav__link> <span class=md-ellipsis> BaseSampler </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> <span class=md-ellipsis> Energy_function </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Energy_function </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/AckleyEnergy/ class=md-nav__link> <span class=md-ellipsis> AckleyEnergy </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/DoubleWellEnergy/ class=md-nav__link> <span class=md-ellipsis> DoubleWellEnergy </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/EnergyFunction/ class=md-nav__link> <span class=md-ellipsis> EnergyFunction </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/GaussianEnergy/ class=md-nav__link> <span class=md-ellipsis> GaussianEnergy </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/HarmonicEnergy/ class=md-nav__link> <span class=md-ellipsis> HarmonicEnergy </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/RastriginEnergy/ class=md-nav__link> <span class=md-ellipsis> RastriginEnergy </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/core/energy_function/classes/RosenbrockEnergy/ class=md-nav__link> <span class=md-ellipsis> RosenbrockEnergy </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> <span class=md-ellipsis> Losses </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> Losses </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/losses/classes/Loss/ class=md-nav__link> <span class=md-ellipsis> Loss </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4> <label class=md-nav__link for=__nav_2_2_4 id=__nav_2_2_4_label tabindex=0> <span class=md-ellipsis> Optimizer </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> Optimizer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/optimizer/classes/Optimizer/ class=md-nav__link> <span class=md-ellipsis> Optimizer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_5> <label class=md-nav__link for=__nav_2_2_5 id=__nav_2_2_5_label tabindex=0> <span class=md-ellipsis> Score_matching </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_5> <span class="md-nav__icon md-icon"></span> Score_matching </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/score_matching/classes/ScoreMatching/ class=md-nav__link> <span class=md-ellipsis> ScoreMatching </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_6> <label class=md-nav__link for=__nav_2_2_6 id=__nav_2_2_6_label tabindex=0> <span class=md-ellipsis> Trainer </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_6> <span class="md-nav__icon md-icon"></span> Trainer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/core/trainer/classes/ContrastiveDivergenceTrainer/ class=md-nav__link> <span class=md-ellipsis> ContrastiveDivergenceTrainer </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../api/torchebm/cuda/ class=md-nav__link> <span class=md-ellipsis> Cuda </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Losses </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Losses </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4_1> <label class=md-nav__link for=__nav_2_4_1 id=__nav_2_4_1_label tabindex=0> <span class=md-ellipsis> Contrastive_divergence </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4_1> <span class="md-nav__icon md-icon"></span> Contrastive_divergence </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/losses/contrastive_divergence/classes/ContrastiveDivergence/ class=md-nav__link> <span class=md-ellipsis> ContrastiveDivergence </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/losses/contrastive_divergence/classes/ContrastiveDivergenceBase/ class=md-nav__link> <span class=md-ellipsis> ContrastiveDivergenceBase </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/losses/contrastive_divergence/classes/ParallelTemperingCD/ class=md-nav__link> <span class=md-ellipsis> ParallelTemperingCD </span> </a> </li> <li class=md-nav__item> <a href=../../api/torchebm/losses/contrastive_divergence/classes/PersistentContrastiveDivergence/ class=md-nav__link> <span class=md-ellipsis> PersistentContrastiveDivergence </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class=md-ellipsis> Models </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Models </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5_1> <label class=md-nav__link for=__nav_2_5_1 id=__nav_2_5_1_label tabindex=0> <span class=md-ellipsis> Base_model </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5_1> <span class="md-nav__icon md-icon"></span> Base_model </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/models/base_model/classes/BaseModel/ class=md-nav__link> <span class=md-ellipsis> BaseModel </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> Samplers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Samplers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_1> <label class=md-nav__link for=__nav_2_6_1 id=__nav_2_6_1_label tabindex=0> <span class=md-ellipsis> Langevin_dynamics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_1> <span class="md-nav__icon md-icon"></span> Langevin_dynamics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/samplers/langevin_dynamics/classes/LangevinDynamics/ class=md-nav__link> <span class=md-ellipsis> LangevinDynamics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6_2> <label class=md-nav__link for=__nav_2_6_2 id=__nav_2_6_2_label tabindex=0> <span class=md-ellipsis> Mcmc </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6_2> <span class="md-nav__icon md-icon"></span> Mcmc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/torchebm/samplers/mcmc/classes/HamiltonianMonteCarlo/ class=md-nav__link> <span class=md-ellipsis> HamiltonianMonteCarlo </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../api/torchebm/utils/ class=md-nav__link> <span class=md-ellipsis> Utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Developer Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../developer_guide/api_generation/ class=md-nav__link> <span class=md-ellipsis> Contribution Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#mathematical-reformation-from-second-order-to-phase-flow class=md-nav__link> <span class=md-ellipsis> Mathematical Reformation: From Second-Order to Phase Flow </span> </a> <nav class=md-nav aria-label="Mathematical Reformation: From Second-Order to Phase Flow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#lagrangian-prelude-action-principles class=md-nav__link> <span class=md-ellipsis> Lagrangian Prelude: Action Principles </span> </a> </li> <li class=md-nav__item> <a href=#newton-vs-lagrange-vs-hamilton-a-philosophical-showdown class=md-nav__link> <span class=md-ellipsis> Newton vs. Lagrange vs. Hamilton: A Philosophical Showdown </span> </a> </li> <li class=md-nav__item> <a href=#hamiltons-equations-the-geometry-of-phase-space class=md-nav__link> <span class=md-ellipsis> Hamilton's Equations: The Geometry of Phase Space </span> </a> </li> <li class=md-nav__item> <a href=#symplecticity-the-sacred-invariant class=md-nav__link> <span class=md-ellipsis> Symplecticity: The Sacred Invariant </span> </a> </li> <li class=md-nav__item> <a href=#how-are-we-going-to-solve-it class=md-nav__link> <span class=md-ellipsis> How are We Going to Solve it? </span> </a> </li> <li class=md-nav__item> <a href=#key-issue-energy-drift-from-non-symplectic-updates class=md-nav__link> <span class=md-ellipsis> Key Issue: Energy Drift from Non-Symplectic Updates </span> </a> </li> <li class=md-nav__item> <a href=#forward-euler-in-hamiltonian-systems class=md-nav__link> <span class=md-ellipsis> Forward Euler in Hamiltonian Systems </span> </a> </li> <li class=md-nav__item> <a href=#step-by-step-failure-harmonic-oscillator-example class=md-nav__link> <span class=md-ellipsis> Step-by-Step Failure: Harmonic Oscillator Example </span> </a> <nav class=md-nav aria-label="Step-by-Step Failure: Harmonic Oscillator Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#jacobian-matrix-analysis class=md-nav__link> <span class=md-ellipsis> Jacobian Matrix Analysis </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#practical-consequences-energy-drift class=md-nav__link> <span class=md-ellipsis> Practical Consequences: Energy Drift </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#symplectic-numerical-integrators class=md-nav__link> <span class=md-ellipsis> Symplectic Numerical Integrators </span> </a> <nav class=md-nav aria-label="Symplectic Numerical Integrators"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#leapfrog-verlet class=md-nav__link> <span class=md-ellipsis> Leapfrog Verlet </span> </a> </li> <li class=md-nav__item> <a href=#why-symplectic-matters class=md-nav__link> <span class=md-ellipsis> Why Symplectic Matters </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hamiltonian-monte-carlo class=md-nav__link> <span class=md-ellipsis> Hamiltonian Monte Carlo </span> </a> <nav class=md-nav aria-label="Hamiltonian Monte Carlo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#from-phase-space-to-probability-space class=md-nav__link> <span class=md-ellipsis> From Phase Space to Probability Space </span> </a> </li> <li class=md-nav__item> <a href=#the-hmc-algorithm class=md-nav__link> <span class=md-ellipsis> The HMC Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#connection-with-energy-based-models class=md-nav__link> <span class=md-ellipsis> Connection with Energy-Based Models </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#potential-research-directions class=md-nav__link> <span class=md-ellipsis> Potential Research Directions </span> </a> <nav class=md-nav aria-label="Potential Research Directions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#symplecticity-in-machine-learning-models class=md-nav__link> <span class=md-ellipsis> Symplecticity in Machine Learning Models </span> </a> </li> <li class=md-nav__item> <a href=#hmc-for-complex-distributions class=md-nav__link> <span class=md-ellipsis> HMC for Complex Distributions: </span> </a> </li> <li class=md-nav__item> <a href=#combining-hamiltonian-mechanics-with-other-ml-techniques class=md-nav__link> <span class=md-ellipsis> Combining Hamiltonian Mechanics with Other ML Techniques: </span> </a> </li> <li class=md-nav__item> <a href=#hamiltonian-gans class=md-nav__link> <span class=md-ellipsis> Hamiltonian GANs </span> </a> </li> <li class=md-nav__item> <a href=#want-to-team-up-on-this class=md-nav__link> <span class=md-ellipsis> Want to Team Up on This 🤓 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#useful-links class=md-nav__link> <span class=md-ellipsis> Useful Links </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=https://github.com/soran-ghaderi.png alt="Soran Ghaderi"> </span> <span class=md-profile__description> <strong> <a href=https://soran-ghaderi.github.io/ >Soran Ghaderi</a> </strong> <br> Looking for PhD & Research Opportunities - MSc in AI at the University of Essex </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg> <time datetime="2025-03-10 00:00:00+00:00" class=md-ellipsis>March 10, 2025</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg> <span class=md-ellipsis> 21 min read </span> </div> </li> </ul> </nav> </li> </ul> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Related links </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href="https://scholar.google.com/citations?user=-2N2iKcAAAAJ&hl=en&authuser=5" class=md-nav__link> <span class=md-ellipsis> Google Scholar </span> </a> </li> <li class=md-nav__item> <a href="https://www.researchgate.net/profile/Soran-Ghaderi?ev=hdr_xprf" class=md-nav__link> <span class=md-ellipsis> ResearchGate </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <nav class=md-tags> <span class=md-tag>hamiltonian</span> <span class=md-tag>sampling</span> </nav> <h1 id=hamiltonian-mechanics>Hamiltonian Mechanics <img alt=✨ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2728.svg title=:sparkles:><a class=headerlink href=#hamiltonian-mechanics title="Permanent link">&para;</a></h1> <p><a class=glightbox href=../../assets/images/blog/hamiltonian/non-L-pendulum.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img alt="Pendulum phase space diagram" height=337.5 src=../../assets/images/blog/hamiltonian/non-L-pendulum.png style="display: block; margin: 0 auto" width=600></a></p> <div style="text-align: justify"> <p> Hamiltonian mechanics is a way to describe how physical systems, like planets or pendulums, move over time, focusing on energy rather than just forces. By reframing complex dynamics through energy lenses, this 19th-century physics framework now powers cutting-edge generative AI. It uses generalized coordinates \( q \) (like position) and their conjugate momenta \( p \) (related to momentum), forming a phase space that captures the system's state. This approach is particularly useful for complex systems with many parts, making it easier to find patterns and conservation laws.</p> </div> <!-- more --> <h2 id=mathematical-reformation-from-second-order-to-phase-flow>Mathematical Reformation: From Second-Order to Phase Flow <img alt=⚙ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2699.svg title=:gear:><a class=headerlink href=#mathematical-reformation-from-second-order-to-phase-flow title="Permanent link">&para;</a></h2> <p>Newton's <span class=arithmatex>\( F = m\ddot{q} \)</span> requires solving second-order differential equations, which become unwieldy for constrained systems or when identifying conserved quantities. </p> <div class="admonition abstract"> <p class=admonition-title>The Core Idea</p> <p><strong>Hamiltonian mechanics splits</strong> <span class=arithmatex>\( \ddot{q} = F(q)/m \)</span> <strong>into two first-order equations</strong> by introducing conjugate momentum <span class=arithmatex>\( p \)</span>:</p> <div class=arithmatex>\[\begin{align*} \dot{q} = \frac{\partial H}{\partial p} &amp; \text{(Position)}, \quad \dot{p} = -\frac{\partial H}{\partial q} &amp; \text{(Momentum)} \end{align*}\]</div> <p>It decomposes acceleration into complementary momentum/position flows. This phase space perspective reveals hidden geometric structure.</p> </div> <h3 id=lagrangian-prelude-action-principles>Lagrangian Prelude: Action Principles<a class=headerlink href=#lagrangian-prelude-action-principles title="Permanent link">&para;</a></h3> <p>The Lagrangian <span class=arithmatex>\( \mathcal{L}(q, \dot{q}) = K - U \)</span> leads to Euler-Lagrange equations via variational calculus: $$ \frac{d}{dt}\left( \frac{\partial \mathcal{L}}{\partial \dot{q}} \right) - \frac{\partial \mathcal{L}}{\partial q} = 0 $$</p> <div class="admonition warning"> <p class=admonition-title>Kinetic Energy Symbol</p> <p>Note that the <span class=arithmatex>\( K \)</span> in the <span class=arithmatex>\( \mathcal{L}(q, \dot{q}) = K - U \)</span> is also represented as <strong><span class=arithmatex>\( T \)</span></strong>.</p> </div> <p>But these remain second-order. The critical leap comes through <strong>Legendre Transformation <span class=arithmatex>\( (\dot{q} \rightarrow p) \)</span></strong>. The Hamiltonian is derived from the Lagrangian through a <strong>Legendre transformation</strong> by defining the conjugate momentum as <span class=arithmatex>\( p_i = \frac{\partial \mathcal{L}}{\partial \dot{q}_i} \)</span>; then the Hamiltonian can be written as: $$ H(q,p) = \sum_i p_i \dot{q}_i - \mathcal{L}(q, \dot{q}) $$</p> <details class=info> <summary>Annotated <span class=arithmatex>\( H(q,p) \)</span></summary> <div class=arithmatex>\[ H(q,p) = \sum_i \underbrace{p_i}_{\text{Conjugate Momentum}} \underbrace{\dot{q}_i}_{\text{Generalized Velocity}} - \underbrace{\mathcal{L}(q, \dot{q})}_{\text{Lagrangian}} \]</div> </details> <p>We can write <span class=arithmatex>\( H(q,p) \)</span> more intuitively as: $$ H(q,p) = K(p) + U(q) $$</p> <div class="admonition question"> <p class=admonition-title>Proof?</p> <p>T is the Kinetic energy; for simplicity, I'll replace it with K.</p> <p>The negative sign arises because we are subtracting the Lagrangian from the sum of the products of momenta and velocities. This ensures that the Hamiltonian represents the total energy of the system for conservative systems, where the Lagrangian is <span class=arithmatex>\( K - U \)</span> and the Hamiltonian becomes <span class=arithmatex>\( K + U \)</span>.</p> <p>For a simple system where <span class=arithmatex>\( K = \frac{1}{2}m\dot{q}^2 \)</span> and <span class=arithmatex>\( U = U(q) \)</span>, the Hamiltonian would be:</p> <ul> <li><strong>Kinetic Energy</strong>: <span class=arithmatex>\( K = \frac{1}{2}m\dot{q}^2 \)</span></li> <li><strong>Potential Energy</strong>: <span class=arithmatex>\( U = U(q) \)</span></li> <li><strong>Lagrangian</strong>: <span class=arithmatex>\( \mathcal{L} = \frac{1}{2}m\dot{q}^2 - U(q) \)</span></li> <li><strong>Conjugate Momentum</strong>: <span class=arithmatex>\( p = m\dot{q} \)</span></li> <li><strong>Hamiltonian</strong>: <span class=arithmatex>\( H = p\dot{q} - \mathcal{L} = p\frac{p}{m} - \left(\frac{1}{2}m\left(\frac{p}{m}\right)^2 - U(q)\right) = \frac{p^2}{m} - \frac{p^2}{2m} + U(q) = \frac{p^2}{2m} + U(q) = K(p) + U(q) \)</span></li> </ul> </div> <p>This flips the script: instead of <span class=arithmatex>\( \dot{q} \)</span>-centric dynamics, we get <strong>symplectic phase flow</strong>.</p> <div class="admonition question"> <p class=admonition-title>Why This Matters</p> <p>The Hamiltonian becomes the system's total energy <span class=arithmatex>\( H = K + U \)</span> for many physical systems. It also provides a framework where time evolution is a <strong>canonical transformation</strong> - a symmetry preserving the fundamental Poisson bracket structure <span class=arithmatex>\( \{q_i, p_j\} = \delta_{ij} \)</span>.</p> <details class=info> <summary>Canonical and Non-Canonical Transformations</summary> <p>A canonical transformation is a change of variables that preserves the form of Hamilton's equations. It's like changing the map projection without altering the landscape.</p> <p>Consider a simple translation: $$ Q = q + a, \quad P = p + b $$ This transformation preserves the Hamiltonian structure and Poisson bracket: <span class=arithmatex>\( \{Q, P\} = \{q + a, p + b\} = \{q, p\} = 1 = \delta_{ij} \)</span></p> <ul> <li>Preserves Hamiltonian structure.</li> <li>Maintains Poisson bracket invariance.</li> <li>Time evolution can be viewed as a canonical transformation.</li> </ul> <p>On the other hand, non-canonical transformation changes the form of Hamilton's equations.</p> <p>For example, consider the transformation:</p> <div class=arithmatex>\[ Q = q^3, \quad P = p^3 \]</div> <p>The Poisson bracket is:</p> <p><span class=arithmatex>\( \{Q, P\} = \frac{\partial Q}{\partial q} \frac{\partial P}{\partial p} - \frac{\partial Q}{\partial p} \frac{\partial P}{\partial q} = 3q^2 \cdot 3p^2 - 0 = 9q^2p^2 \neq 1 \)</span></p> <details class=question> <summary>How to calculate those formula?</summary> <p>The Poisson bracket of two functions <span class=arithmatex>\( f \)</span> and <span class=arithmatex>\( g \)</span> is defined as: <span class=arithmatex>\( \{f, g\} = \sum_i \left( \frac{\partial f}{\partial q_i} \frac{\partial g}{\partial p_i} - \frac{\partial f}{\partial p_i} \frac{\partial g}{\partial q_i} \right) \)</span></p> <p><strong>Transformation 1: <span class=arithmatex>\( Q = q + a, \quad P = p + b \)</span></strong></p> <p><strong>Partial Derivatives</strong>: </p> <ul> <li><span class=arithmatex>\( \frac{\partial Q}{\partial q} = 1 \)</span></li> <li><span class=arithmatex>\( \frac{\partial Q}{\partial p} = 0 \)</span></li> <li><span class=arithmatex>\( \frac{\partial P}{\partial q} = 0 \)</span></li> <li><span class=arithmatex>\( \frac{\partial P}{\partial p} = 1 \)</span></li> </ul> <p>These derivatives can be represented in matrix form as: <span class=arithmatex>\( \frac{\partial (Q, P)}{\partial (q, p)} = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix} \)</span></p> <p>This is a diagonal identity matrix, indicating that the transformation preserves the original structure.</p> <p><strong>Poisson Bracket Calculation</strong> <span class=arithmatex>\( \{Q, P\} = \frac{\partial Q}{\partial q} \frac{\partial P}{\partial p} - \frac{\partial Q}{\partial p} \frac{\partial P}{\partial q} = (1)(1) - (0)(0) = 1 \)</span></p> <hr> <p><strong>Transformation 2: <span class=arithmatex>\( Q = q^3, \quad P = p^3 \)</span></strong></p> <p><strong>Partial Derivatives</strong> - <span class=arithmatex>\( \frac{\partial Q}{\partial q} = 3q^2 \)</span> - <span class=arithmatex>\( \frac{\partial Q}{\partial p} = 0 \)</span> - <span class=arithmatex>\( \frac{\partial P}{\partial q} = 0 \)</span> - <span class=arithmatex>\( \frac{\partial P}{\partial p} = 3p^2 \)</span></p> <p>These derivatives can be represented as: <span class=arithmatex>\( \frac{\partial (Q, P)}{\partial (q, p)} = \begin{pmatrix} 3q^2 &amp; 0 \\ 0 &amp; 3p^2 \end{pmatrix} \)</span></p> <p>This is a diagonal matrix but not the identity matrix, indicating that the transformation does not preserve the original structure.</p> <p><strong>Poisson Bracket Calculation</strong> <span class=arithmatex>\( \{Q, P\} = \frac{\partial Q}{\partial q} \frac{\partial P}{\partial p} - \frac{\partial Q}{\partial p} \frac{\partial P}{\partial q} = (3q^2)(3p^2) - (0)(0) = 9q^2p^2 \)</span></p> <ul> <li><strong>Transformation 1</strong> preserves the Poisson bracket structure because it results in a constant value of 1, represented by an identity matrix.</li> <li><strong>Transformation 2</strong> does not preserve the Poisson bracket structure because the result depends on <span class=arithmatex>\( q \)</span> and <span class=arithmatex>\( p \)</span>, represented by a non-identity diagonal matrix.</li> </ul> </details> </details> </div> <p>This transformation is not canonical because it does not preserve the Poisson bracket structure.</p> <h3 id=newton-vs-lagrange-vs-hamilton-a-philosophical-showdown>Newton vs. Lagrange vs. Hamilton: A Philosophical Showdown<a class=headerlink href=#newton-vs-lagrange-vs-hamilton-a-philosophical-showdown title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Aspect</th> <th>Newtonian</th> <th>Lagrangian</th> <th>Hamiltonian</th> </tr> </thead> <tbody> <tr> <td><strong>State Variables</strong></td> <td>Position <span class=arithmatex>\( x \)</span> and velocity <span class=arithmatex>\( \dot{x} \)</span></td> <td>Generalized coordinates <span class=arithmatex>\( q \)</span> and velocities <span class=arithmatex>\( \dot{q} \)</span></td> <td>Generalized coordinates <span class=arithmatex>\( q \)</span> and conjugate momenta <span class=arithmatex>\( p \)</span></td> </tr> <tr> <td><strong>Formulation</strong></td> <td>Second-order differential equations <span class=arithmatex>\( (F=ma) \)</span></td> <td>Principle of least action (<span class=arithmatex>\( \delta \int L \, dt = 0 \)</span>)</td> <td>First-order differential equations from Hamiltonian function (Phase flow <span class=arithmatex>\( (dH) \)</span>)</td> </tr> <tr> <td><strong>Identifying Symmetries</strong></td> <td>Manual identification or through specific methods</td> <td>Noether's theorem</td> <td>Canonical transformations and Poisson brackets</td> </tr> <tr> <td><strong>Machine Learning Connection</strong></td> <td>Physics-informed neural networks, simulations</td> <td>Optimal control, reinforcement learning</td> <td>Hamiltonian Monte Carlo (HMC) sampling, energy-based models</td> </tr> <tr> <td><strong>Energy Conservation</strong></td> <td>Not inherent (must be derived)</td> <td>Built-in through conservation laws</td> <td>Central (Hamiltonian is energy)</td> </tr> <tr> <td><strong>General Coordinates</strong></td> <td>Possible, but often cumbersome</td> <td>Natural fit</td> <td>Natural fit</td> </tr> <tr> <td><strong>Time Reversibility</strong></td> <td>Yes</td> <td>Yes</td> <td>Yes, especially in symplectic formulations</td> </tr> </tbody> </table> <h3 id=hamiltons-equations-the-geometry-of-phase-space>Hamilton's Equations: The Geometry of Phase Space <img alt=⚙ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2699.svg title=:gear:><a class=headerlink href=#hamiltons-equations-the-geometry-of-phase-space title="Permanent link">&para;</a></h3> <p>The phase space is a mathematical space where we can represent the set of possible states of a physical system. For a system with <span class=arithmatex>\( n \)</span> degrees of freedom, the phase space is a <span class=arithmatex>\( 2n \)</span>-dimensional space, often visualized as a map where each point <span class=arithmatex>\( (q, p) \)</span> represents a unique state. The evolution of the system is described by the motion of a point in this space, governed by Hamilton's equations.</p> <figure> <video width=640 height=360 autoplay loop muted> <source src=../../assets/images/blog/hamiltonian/pendulum_phase_space.mp4 type=video/mp4> Your browser does not support the video tag. </video> <figcaption> Phase space portrait of a nonlinear pendulum showing oscillatory motion (closed orbits), rotational motion (wavy trajectories), and separatrices (red curves) connecting unstable equilibrium points. Position (q) and momentum (p) dynamics illustrate energy conservation principles fundamental to Hamiltonian systems. </figcaption> </figure> <p>This formulation offers several advantages. It makes it straightforward to identify conserved quantities and symmetries through canonical transformations and Poisson brackets, which provides deeper insights into the system's behavior. For instance, Liouville's theorem states that the volume in phase space occupied by an ensemble of systems remains constant over time, expressed as:</p> <div class=arithmatex>\[ \frac{\partial \rho}{\partial t} + \{\rho, H\} = 0 \]</div> <p>or equivalently:</p> <div class=arithmatex>\[ \frac{\partial \rho}{\partial t} + \sum_i \left(\frac{\partial \rho}{\partial q_i}\frac{\partial H}{\partial p_i} - \frac{\partial \rho}{\partial p_i}\frac{\partial H}{\partial q_i}\right) = 0 \]</div> <p>where <span class=arithmatex>\( \rho(q, p, t) \)</span> is the density function. This helps us to represent the phase space flows and how they preserve area under symplectic transformations. Its relation to <a href=https://en.wikipedia.org/wiki/Symplectic_geometry>symplectic geometry</a> enables mathematical properties that are directly relevant to many numerical methods. For instance, it enables Hamiltonian Monte Carlo to perform well in high-dimensions by defining MCMC strategies that increases the chances of accepting a sample (particle). </p> <h3 id=symplecticity-the-sacred-invariant>Symplecticity: The Sacred Invariant<a class=headerlink href=#symplecticity-the-sacred-invariant title="Permanent link">&para;</a></h3> <p>Hamiltonian flows preserve the symplectic 2-form <span class=arithmatex>\( \omega = \sum_i dq_i \wedge dp_i \)</span>. </p> <details class=info> <summary>Symplectic 2-form <span class=arithmatex>\( \omega \)</span></summary> <p>The symplectic 2-form, denoted by <span class=arithmatex>\( \omega = \sum_i dq_i \wedge dp_i \)</span>, is a mathematical object used in symplectic geometry. It measures the area of parallelograms formed by vectors in the tangent space of a phase space.</p> <ul> <li><strong><span class=arithmatex>\( dq_i \)</span> and <span class=arithmatex>\( dp_i \)</span></strong>: Infinitesimal changes in position and momentum coordinates.</li> <li><strong><span class=arithmatex>\( \wedge \)</span></strong>: The wedge product, which combines differential forms in an antisymmetric way meaning that <span class=arithmatex>\( dq_i \wedge dp_i = -dp_i \wedge dq_i \)</span>.</li> <li><strong><span class=arithmatex>\( \sum_i \)</span></strong>: Sum over all degrees of freedom.</li> </ul> <p>Imagine a phase space where each point represents a state of a physical system. The symplectic form assigns a value to each pair of vectors, effectively measuring the area of the parallelogram they span. This area is preserved under Hamiltonian flows.</p> <p><strong>Key Properties</strong></p> <ol> <li><strong>Closed</strong>: <span class=arithmatex>\( d\omega = 0 \)</span> which means its exterior derivative is zero <span class=arithmatex>\( d\omega=0 \)</span>. This property ensures that the form does not change under continuous transformations.</li> <li><strong>Non-degenerate</strong>: The form is non-degenerate if <span class=arithmatex>\( d\omega(X,Y)=0 \)</span> for all <span class=arithmatex>\( Y \)</span>s, then <span class=arithmatex>\( X=0 \)</span>. This ensures that every vector has a unique "partner" vector such that their pairing under <span class=arithmatex>\( \omega \)</span> is non-zero.</li> </ol> <p><strong>Example</strong></p> <p>For a simple harmonic oscillator with one degree of freedom, <span class=arithmatex>\( \omega = dq \wedge dp \)</span>. This measures the area of parallelograms in the phase space spanned by vectors representing changes in position and momentum.</p> <p><strong>A Very Simplistic PyTorch Code</strong>: While PyTorch doesn't directly handle differential forms, you can conceptually represent the symplectic form using tensors:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>torch</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=c1># Conceptual representation of dq and dp as tensors</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>dq</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>  
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>dp</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>tensor</span><span class=p>([</span><span class=mf>1.0</span><span class=p>])</span>  
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># &quot;Wedge product&quot; conceptually represented using an outer product</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>omega</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>dq</span><span class=p>,</span> <span class=n>dp</span><span class=p>)</span> <span class=o>-</span> <span class=n>torch</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>dp</span><span class=p>,</span> <span class=n>dq</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=nb>print</span><span class=p>(</span><span class=n>omega</span><span class=p>)</span>
</span></code></pre></div> <p>This code illustrates the antisymmetric nature of the wedge product.</p> </details> <p>Numerically, this means good integrators must respect:</p> <div class=arithmatex>\[ \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))}^T J \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} = J \quad \text{where } J = \begin{pmatrix} 0 &amp; I \\ -I &amp; 0 \end{pmatrix} \]</div> <details class=info> <summary>Breaking Down the Formula</summary> <ul> <li><strong>Geometric numerical integration</strong> solves differential equations while preserving geometric properties of the system.</li> <li> <p><strong>Symplecticity</strong> is a geometric property inherent to Hamiltonian systems. It ensures that the area of geometric structures (e.g., parallelograms) in phase space <span class=arithmatex>\( (q, p) \)</span> remains constant over time. This is encoded in the symplectic form <span class=arithmatex>\( \omega = \sum_i dq_i \wedge dp_i \)</span>.</p> </li> <li> <p>A numerical method is <strong>symplectic</strong> if it preserves <span class=arithmatex>\( \omega \)</span>. The Jacobian matrix of the transformation from <span class=arithmatex>\( (q(t), p(t)) \)</span> to <span class=arithmatex>\( (q(t + \epsilon), p(t + \epsilon)) \)</span> must satisfy the condition above.</p> </li> <li> <p>The <strong>Jacobian matrix</strong> <span class=arithmatex>\( \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} \)</span> quantifies how small changes in the initial state <span class=arithmatex>\( (q(t), p(t)) \)</span> propagate to the next state <span class=arithmatex>\( (q(t + \epsilon), p(t + \epsilon)) \)</span>.</p> </li> <li> <p><strong><span class=arithmatex>\( q(t) \)</span> and <span class=arithmatex>\( p(t) \)</span></strong> : Position and momentum at time <span class=arithmatex>\( t \)</span>.</p> </li> <li><strong><span class=arithmatex>\( q(t + \epsilon) \)</span> and <span class=arithmatex>\( p(t + \epsilon) \)</span></strong> : Updated position and momentum after one time step <span class=arithmatex>\( \epsilon \)</span>.</li> <li><strong><span class=arithmatex>\( \frac{\partial}{\partial (q(t), p(t))} \)</span></strong> : Partial derivatives with respect to the initial state.</li> </ul> </details> <h3 id=how-are-we-going-to-solve-it>How are We Going to Solve it?<a class=headerlink href=#how-are-we-going-to-solve-it title="Permanent link">&para;</a></h3> <p>Numerical solvers for differential equations inevitably introduce errors that affect solution accuracy. These errors manifest as deviations from the true trajectory in phase space, particularly noticeable in energy-conserving systems like the harmonic oscillator. The errors fall into two main categories: local truncation error, arising from the approximation of continuous derivatives with discrete steps (proportional to <span class=arithmatex>\( \mathcal{O}(\epsilon^n+1) \)</span> where <span class=arithmatex>\( \epsilon \)</span> is the step size and n depends on the method); and global accumulation error, which compounds over integration time.</p> <div class="admonition bug"> <p class=admonition-title>Forward Euler Method Fails at This!</p> <h3 id=key-issue-energy-drift-from-non-symplectic-updates>Key Issue: Energy Drift from Non-Symplectic Updates<a class=headerlink href=#key-issue-energy-drift-from-non-symplectic-updates title="Permanent link">&para;</a></h3> <p>The forward Euler method (FEM) violates the geometric structure of Hamiltonian systems, leading to <strong>energy drift</strong> in long-term simulations. Let’s dissect why.</p> <hr> <h3 id=forward-euler-in-hamiltonian-systems>Forward Euler in Hamiltonian Systems<a class=headerlink href=#forward-euler-in-hamiltonian-systems title="Permanent link">&para;</a></h3> <p>For a Hamiltonian <span class=arithmatex>\( H(q, p) \)</span>, the forward Euler updates position and momentum as: <span class=arithmatex>\( q(t + \epsilon) = q(t) + \epsilon \frac{\partial H}{\partial p}(q(t), p(t)),\quad p(t + \epsilon) = p(t) - \epsilon \frac{\partial H}{\partial q}(q(t), p(t)) \)</span></p> <p>Unlike Leapfrog Verlet, these updates <strong>do not split</strong> the position/momentum dependencies, breaking symplecticity.</p> <hr> <h3 id=step-by-step-failure-harmonic-oscillator-example>Step-by-Step Failure: Harmonic Oscillator Example<a class=headerlink href=#step-by-step-failure-harmonic-oscillator-example title="Permanent link">&para;</a></h3> <p><strong>Hamiltonian</strong>: <span class=arithmatex>\( H = \frac{1}{2}(q^2 + p^2) \quad \text{(mass-spring system with m = k = 1 )} \)</span></p> <p><strong>Forward Euler Updates</strong>: <span class=arithmatex>\( q(t + \epsilon) = q(t) + \epsilon p(t) \quad \text{(position update)} \quad p(t + \epsilon) = p(t) - \epsilon q(t) \quad \text{(momentum update)} \)</span></p> <hr> <h4 id=jacobian-matrix-analysis>Jacobian Matrix Analysis<a class=headerlink href=#jacobian-matrix-analysis title="Permanent link">&para;</a></h4> <p>The Jacobian <span class=arithmatex>\( M = \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} \)</span> becomes: <span class=arithmatex>\( M = \begin{pmatrix} 1 &amp; \epsilon \\ -\epsilon &amp; 1 \end{pmatrix} \)</span></p> <p><strong>Symplectic Condition Check</strong>:<br> Does <span class=arithmatex>\( M^T J M = J \)</span>, where <span class=arithmatex>\( J = \begin{pmatrix} 0 &amp; 1 \\ -1 &amp; 0 \end{pmatrix} \)</span>?</p> <ol> <li> <p><strong>Transpose <span class=arithmatex>\( M^T \)</span></strong>: <span class=arithmatex>\( M^T = \begin{pmatrix} 1 &amp; -\epsilon \\ \epsilon &amp; 1 \end{pmatrix} \)</span></p> </li> <li> <p><strong>Compute <span class=arithmatex>\( J M \)</span></strong>: <span class=arithmatex>\( J M = \begin{pmatrix} -\epsilon &amp; 1 \\ -1 &amp; -\epsilon \end{pmatrix} \)</span></p> </li> <li> <p><strong>Final Product <span class=arithmatex>\( M^T J M \)</span></strong>: <span class=arithmatex>\( M^T J M = \begin{pmatrix} 0 &amp; 1 + \epsilon^2 \\ -1 - \epsilon^2 &amp; 0 \end{pmatrix} \neq J \)</span></p> </li> </ol> <p>The result violates <span class=arithmatex>\( M^T J M = J \)</span>, proving <strong>symplecticity fails</strong> unless <span class=arithmatex>\( \epsilon = 0 \)</span>.</p> <div class=arithmatex>\[ \boxed{\frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))}^T J \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} \neq J} \]</div> <hr> <h3 id=practical-consequences-energy-drift>Practical Consequences: Energy Drift<a class=headerlink href=#practical-consequences-energy-drift title="Permanent link">&para;</a></h3> <div class="admonition failure"> <p class=admonition-title>Why This Matters</p> <ul> <li><strong>Energy Drift</strong>: FEM artificially injects/dissipates energy over time because <span class=arithmatex>\( H(q,p) \)</span> is not conserved. </li> <li><strong>Phase Space Distortion</strong>: Volume preservation fails, corrupting long-term trajectories. </li> <li><strong>Unusable for HMC</strong>: Sampling in Hamiltonian Monte Carlo relies on symplectic integrators to maintain detailed balance. </li> </ul> <p><strong>Example</strong>: Simulating a harmonic oscillator with FEM shows spiraling/non-closing orbits in phase space, unlike the stable ellipses from Leapfrog Verlet.</p> </div> </div> <p>To overcome this, we turn to symplectic integrators—methods that respect the underlying geometry of Hamiltonian systems, leading us naturally to the Leapfrog Verlet method, a powerful symplectic alternative. 🚀</p> <h2 id=symplectic-numerical-integrators>Symplectic Numerical Integrators <img alt=💻 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f4bb.svg title=:computer:><a class=headerlink href=#symplectic-numerical-integrators title="Permanent link">&para;</a></h2> <h3 id=leapfrog-verlet>Leapfrog Verlet<a class=headerlink href=#leapfrog-verlet title="Permanent link">&para;</a></h3> <p>For a separable Hamiltonian <span class=arithmatex>\( H(q,p) = K(p) + U(q) \)</span>, where the corresponding probability distribution is given by:</p> <div class=arithmatex>\[ P(q,p) = \frac{1}{Z} e^{-U(q)} e^{-K(p)}, \]</div> <p>the Leapfrog Verlet integrator proceeds as follows:</p> <div class=arithmatex>\[ \begin{aligned} p_{i}\left(t + \frac{\epsilon}{2}\right) &amp;= p_{i}(t) - \frac{\epsilon}{2} \frac{\partial U}{\partial q_{i}}(q(t)) \\ q_{i}(t + \epsilon) &amp;= q_{i}(t) + \epsilon \frac{\partial K}{\partial p_{i}}\left(p\left(t + \frac{\epsilon}{2}\right)\right) \\ p_{i}(t + \epsilon) &amp;= p_{i}\left(t + \frac{\epsilon}{2}\right) - \frac{\epsilon}{2} \frac{\partial U}{\partial q_{i}}(q(t + \epsilon)) \end{aligned} \]</div> <p>This Störmer-Verlet scheme preserves symplecticity exactly, with local error <span class=arithmatex>\( \mathcal{O}(\epsilon^3) \)</span> and global error <span class=arithmatex>\( \mathcal{O}(\epsilon^2) \)</span>. You can read more about <cite><a href=https://lemesurierb.people.charleston.edu/numerical-methods-and-analysis-python/main/ODE-IVP-6-multi-step-methods-introduction-python.html> numerical methods and analysis in Python here</a></cite>.</p> <div class="admonition question"> <p class=admonition-title>How Exactly?</p> <ol> <li> <p><strong>Leapfrog Verlet Update Equations</strong><br> For a separable Hamiltonian <span class=arithmatex>\( H(q, p) = K(p) + U(q) \)</span>, the method splits into three component-wise steps:</p> <ol> <li> <p><strong>Half-step momentum update</strong>: <span class=arithmatex>\( p_{i}\left(t + \frac{\epsilon}{2}\right) = p_{i}(t) - \frac{\epsilon}{2} \frac{\partial U}{\partial q_{i}}(q(t)) \)</span></p> </li> <li> <p><strong>Full-step position update</strong>: <span class=arithmatex>\( q_{i}(t + \epsilon) = q_{i}(t) + \epsilon \frac{\partial K}{\partial p_{i}}\left(p\left(t + \frac{\epsilon}{2}\right)\right) \)</span></p> </li> <li> <p><strong>Full-step momentum update</strong>: <span class=arithmatex>\( p_{i}(t + \epsilon) = p_{i}\left(t + \frac{\epsilon}{2}\right) - \frac{\epsilon}{2} \frac{\partial U}{\partial q_{i}}(q(t + \epsilon)) \)</span></p> </li> </ol> </li> <li> <p><strong>Jacobian Matrix Calculation</strong><br> For the harmonic oscillator <span class=arithmatex>\( H(q, p) = \frac{1}{2}(q^2 + p^2) \)</span>, the updates simplify to: </p> <div class=arithmatex>\[ q(t + \epsilon) = q(t) + \epsilon p(t) - \frac{\epsilon^2}{2} q(t), \quad p(t + \epsilon) = p(t) - \epsilon q(t) - \frac{\epsilon^2}{2} p(t). \]</div> <p>The Jacobian matrix <span class=arithmatex>\( M = \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} \)</span> becomes: <span class=arithmatex>\( M = \begin{pmatrix} 1 - \frac{\epsilon^2}{2} &amp; \epsilon \\ -\epsilon &amp; 1 - \frac{\epsilon^2}{2} \end{pmatrix}. \)</span></p> </li> <li> <p><strong>Transpose of <span class=arithmatex>\( M \)</span></strong><br> The transpose <span class=arithmatex>\( M^T \)</span> swaps off-diagonal terms: <span class=arithmatex>\( M^T = \begin{pmatrix} 1 - \frac{\epsilon^2}{2} &amp; -\epsilon \\ \epsilon &amp; 1 - \frac{\epsilon^2}{2} \end{pmatrix}. \)</span></p> </li> <li> <p><strong>Verify <span class=arithmatex>\( M^T J M = J \)</span></strong><br> Let <span class=arithmatex>\( J = \begin{pmatrix} 0 &amp; 1 \\ -1 &amp; 0 \end{pmatrix} \)</span>. Compute <span class=arithmatex>\( M^T J M \)</span>:</p> <ol> <li> <p><strong>Calculate</strong>: <span class=arithmatex>\( J M = \begin{pmatrix} -\epsilon &amp; 1 - \frac{\epsilon^2}{2} \\ -\left(1 - \frac{\epsilon^2}{2}\right) &amp; -\epsilon \end{pmatrix}. \)</span></p> </li> <li> <p><strong>Calculate</strong>: <span class=arithmatex>\( M^T J M = \begin{pmatrix} 1 - \frac{\epsilon^2}{2} &amp; -\epsilon \\ \epsilon &amp; 1 - \frac{\epsilon^2}{2} \end{pmatrix} \begin{pmatrix} -\epsilon &amp; 1 - \frac{\epsilon^2}{2} \\ -\left(1 - \frac{\epsilon^2}{2}\right) &amp; -\epsilon \end{pmatrix}. \)</span></p> </li> </ol> <p>After matrix multiplication: <span class=arithmatex>\( M^T J M = \begin{pmatrix} 0 &amp; 1 \\ -1 &amp; 0 \end{pmatrix} = J. \)</span></p> </li> </ol> <p>The Leapfrog Verlet method satisfies <span class=arithmatex>\( M^T J M = J \)</span>, proving it <strong>preserves the symplectic structure</strong>. This matches its theoretical property as a symplectic integrator.</p> <div class=arithmatex>\[ \boxed{\frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))}^T J \frac{\partial (q(t + \epsilon), p(t + \epsilon))}{\partial (q(t), p(t))} = J} \]</div> </div> <h3 id=why-symplectic-matters>Why Symplectic Matters<a class=headerlink href=#why-symplectic-matters title="Permanent link">&para;</a></h3> <p>They're the <strong>reversible neural nets</strong> of physics simulations!</p> <p>Symplectic integrators like Leapfrog Verlet are critical for <strong>long-term stability</strong> in Hamiltonian systems. </p> <ul> <li><strong>Phase space preservation</strong>: The volume in <span class=arithmatex>\( (q, p) \)</span>-space is conserved exactly, avoiding artificial energy drift. </li> <li><strong>Approximate energy conservation</strong>: While energy <span class=arithmatex>\( H(q,p) \)</span> is not perfectly conserved (due to <span class=arithmatex>\( \mathcal{O}(\epsilon^2) \)</span> error), it oscillates near the true value over exponentially long timescales. </li> <li><strong>Practical relevance</strong>: This makes symplectic integrators indispensable in molecular dynamics and Hamiltonian Monte Carlo (HMC), where accurate sampling relies on stable trajectories. </li> </ul> <figure> <a class=glightbox href=../../assets/images/blog/hamiltonian/numerical_err.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../../assets/images/blog/hamiltonian/numerical_err.png alt="Numerical Errors" width=95%></a> <figcaption> Comparison of numerical integration methods for a simple harmonic oscillator in phase space. Color gradients indicate error magnitude with brighter colors showing larger divergence from the exact solution (white). Euler's method (a) exhibits energy growth, Modified Euler's method (b) shows improved stability, while Leapfrog maintains excellent energy conservation at small stepsize (c) but develops geometric distortion at larger stepsize (d). </figcaption> </figure> <p>Euler's method (first-order) systematically injects energy into the system, causing the characteristic outward spiral seen in the plots. Modified Euler's method (second-order) significantly reduces this energy drift. Most importantly, symplectic integrators like the Leapfrog method preserve the geometric structure of Hamiltonian systems even with relatively large step sizes by maintaining phase space volume conservation. This structural preservation is why Leapfrog remains the preferred method for long-time simulations in molecular dynamics and astronomy, where energy conservation is critical despite the visible polygon-like discretization artifacts at large step sizes.</p> <p>Non-symplectic methods (e.g., Euler-Maruyama) often fail catastrophically in these settings.</p> <table> <thead> <tr> <th>Integrator</th> <th>Symplecticity</th> <th>Order</th> <th>Type</th> <th>Local Error</th> <th>Global Error</th> <th>Suitable For</th> <th>Computational Cost</th> </tr> </thead> <tbody> <tr> <td>Euler Method</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>1</td> <td>Explicit</td> <td>O(ε²)</td> <td>O(ε)</td> <td>Quick prototypes and Short-term simulations of general ODEs</td> <td>Low</td> </tr> <tr> <td>Symplectically Euler</td> <td><img alt=✔ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2714.svg title=:heavy_check_mark:></td> <td>1</td> <td>Explicit</td> <td>O(ε²)</td> <td>O(ε)</td> <td>Simple Hamiltonian systems</td> <td>Low</td> </tr> <tr> <td>Leapfrog (Verlet)</td> <td><img alt=✔ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2714.svg title=:heavy_check_mark:></td> <td>2</td> <td>Explicit</td> <td>O(ε³)</td> <td>O(ε²)</td> <td>Molecular dynamics, Long-term simulations of Hamiltonian systems</td> <td>Moderate</td> </tr> <tr> <td>Runge-Kutta 4</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>4</td> <td>Explicit</td> <td>O(ε⁵)</td> <td>O(ε⁴)</td> <td>Short-term accuracy, General ODEs, but not recommended for long-term Hamiltonian systems</td> <td>High</td> </tr> <tr> <td>Forest-Ruth Integrator</td> <td><img alt=✔ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2714.svg title=:heavy_check_mark:></td> <td>4</td> <td>Explicit</td> <td>O(ε⁵)</td> <td>O(ε⁴)</td> <td>High-accuracy long-term simulations</td> <td>High</td> </tr> <tr> <td>Yoshida 6th-order</td> <td><img alt=✔ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2714.svg title=:heavy_check_mark:></td> <td>6</td> <td>Explicit</td> <td>O(ε⁷)</td> <td>O(ε⁶)</td> <td>High-accuracy</td> <td>High</td> </tr> <tr> <td>Heun’s Method (RK2)</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>2</td> <td>Explicit</td> <td>O(ε³)</td> <td>O(ε²)</td> <td>General ODEs requiring moderate accuracy</td> <td>Moderate</td> </tr> <tr> <td>Third-order Runge-Kutta</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>3</td> <td>Explicit</td> <td>O(ε⁴)</td> <td>O(ε³)</td> <td>When higher accuracy than RK2 is needed without the cost of RK4</td> <td>High</td> </tr> <tr> <td>Implicit Midpoint Rule</td> <td><img alt=✔ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2714.svg title=:heavy_check_mark:></td> <td>2</td> <td>Implicit (solving equations)</td> <td>O(ε³)</td> <td>O(ε²)</td> <td>Hamiltonian systems, stiff problems</td> <td>High</td> </tr> <tr> <td>Fourth-order Adams-Bashforth</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>4</td> <td>Multi-step (explicit)</td> <td>O(ε⁵)</td> <td>O(ε⁴)</td> <td>Non-stiff problems with smooth solutions, after initial steps</td> <td>Low</td> </tr> <tr> <td>Backward Euler Method</td> <td><img alt=❌ class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg title=:x:></td> <td>1</td> <td>Implicit (solving equations)</td> <td>O(ε²)</td> <td>O(ε)</td> <td>Stiff problems, where stability is crucial</td> <td>High</td> </tr> </tbody> </table> <h2 id=hamiltonian-monte-carlo>Hamiltonian Monte Carlo<a class=headerlink href=#hamiltonian-monte-carlo title="Permanent link">&para;</a></h2> <p>Hamiltonian Monte Carlo (HMC) is a Markov chain Monte Carlo (MCMC) method that leverages Hamiltonian dynamics to efficiently sample from complex probability distributions, particularly in Bayesian statistics and machine learning.</p> <h3 id=from-phase-space-to-probability-space>From Phase Space to Probability Space<a class=headerlink href=#from-phase-space-to-probability-space title="Permanent link">&para;</a></h3> <p>HMC interprets target distribution <span class=arithmatex>\( P(z) \)</span> as a Boltzmann distribution:</p> <div class=arithmatex>\[ P(z) = \frac{1}{Z} e^{\frac{-E(z)}{T}} \]</div> <p>Substituting into this formulation, the Hamiltonian gives us a joint density:</p> <div class=arithmatex>\[ P(q,p) = \frac{1}{Z} e^{-U(q)} e^{-K(p)} \quad \text{where } U(q) = -\log[p(q), p(q|D)] \]</div> <p>where <span class=arithmatex>\( p(q|D) \)</span> is the likelihood of the given data <span class=arithmatex>\( D \)</span> and T=1 and therefore removed. We estimate our posterior distribution using the potential energy <span class=arithmatex>\( U(q) \)</span> since <span class=arithmatex>\( P(q,p) \)</span> consists of two independent probability distributions.</p> <p>Augment with artificial momentum <span class=arithmatex>\( p \sim \mathcal{N}(0,M) \)</span>, then simulate Hamiltonian dynamics to propose new <span class=arithmatex>\( q' \)</span> based on the distribution of the position variables <span class=arithmatex>\( U(q) \)</span> which acts as the "potential energy" of the target distribution <span class=arithmatex>\( P(q) \)</span>, thereby creating valleys at high-probability regions.</p> <p>For more on HMC, check out <a href=https://arxiv.org/abs/1701.02434>this explanation</a> or <a href=https://mc-stan.org/docs/2_19/reference-manual/hamiltonian-monte-carlo.html>this tutorial</a>.</p> <div class="admonition tip"> <ul> <li><strong>Physical Systems</strong>: <span class=arithmatex>\( H(q,p) = U(q) + K(p) \)</span> represents total energy </li> <li><strong>Sampling Systems</strong>: <span class=arithmatex>\( H(q,p) = -\log P(q) + \frac{1}{2}p^T M^{-1} p \)</span> defines exploration dynamics </li> </ul> </div> <p>The kinetic energy with the popular form of <span class=arithmatex>\( K(p) = \frac{1}{2}p^T M^{-1} p \)</span>, often Gaussian, injects momentum to traverse these landscapes. Crucially, the mass matrix <span class=arithmatex>\( M \)</span> plays the role of a <strong>preconditioner</strong> - diagonal <span class=arithmatex>\( M \)</span> adapts to parameter scales, while dense <span class=arithmatex>\( M \)</span> can align with correlation structure. <span class=arithmatex>\( M \)</span> is symmetric, positive definite and typically diagonal.</p> <div class="admonition question"> <p class=admonition-title>What is Positive Definite?</p> <p><strong>Positive Definite</strong>: For any non-zero vector <span class=arithmatex>\( x \)</span>, the expression <span class=arithmatex>\( x^T M x \)</span> is always positive. This ensures stability and efficiency.</p> <p><figure> <a class=glightbox href=../../assets/images/blog/hamiltonian/quadratics.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=../../assets/images/blog/hamiltonian/quadratics.png alt="quadratics diagram" width=95%></a> <figcaption> Illustration of different quadratic forms in two variables that shows how different covariance matrices influence the shape of these forms. The plots depict:<br> a) <strong>Positive Definite Form</strong>: A bowl-shaped surface where all eigenvalues are positive, indicating a minimum.<br> b) <strong>Negative Definite Form</strong>: An inverted bowl where all eigenvalues are negative, indicating a maximum.<br> c) <strong>Indefinite Form</strong>: A saddle-shaped surface with both positive and negative eigenvalues, indicating neither a maximum nor a minimum.<br> Each subplot includes the matrix <span class=arithmatex>\( M \)</span> and the corresponding quadratic form <span class=arithmatex>\( Q(x) = x^T M x \)</span>. </figcaption> </figure></p> <div class=arithmatex>\[ x^T M x &gt; 0 \]</div> </div> <details class=example> <summary>Kinetic Energy Choices</summary> <ul> <li><strong>Gaussian (Standard HMC)</strong>: <span class=arithmatex>\( K(p) = \frac{1}{2}p^T M^{-1} p \)</span><br> Yields Euclidean trajectories, efficient for moderate dimensions. </li> <li><strong>Relativistic (Riemannian HMC)</strong>: <span class=arithmatex>\( K(p) = \sqrt{p^T M^{-1} p + c^2} \)</span><br> Limits maximum velocity, preventing divergences in ill-conditioned spaces. </li> <li><strong>Adaptive (Surrogate Gradients)</strong>: Learn <span class=arithmatex>\( K(p) \)</span> via neural networks to match target geometry.</li> </ul> </details> <div class="admonition tip"> <p class=admonition-title>Key Intuition</p> <p>The Hamiltonian <span class=arithmatex>\( H(q,p) = U(q) + \frac{1}{2}p^T M^{-1} p \)</span> creates an energy landscape where momentum <strong>carries the sampler through high-probability regions</strong>, avoiding random walk behavior.</p> </div> <h3 id=the-hmc-algorithm>The HMC Algorithm<a class=headerlink href=#the-hmc-algorithm title="Permanent link">&para;</a></h3> <p>The algorithm involves:</p> <ol> <li> <p><strong>Initialization</strong>: Start with an initial position <span class=arithmatex>\( q_0 \)</span> and sample momentum <span class=arithmatex>\( p_0 \sim \mathcal{N}(0,M) \)</span>.</p> </li> <li> <p><strong>Leapfrog Integration</strong>: Use the leapfrog method to approximate Hamiltonian dynamics. For a step size <span class=arithmatex>\( \epsilon \)</span> and L steps, update:</p> </li> <li> <p>Half-step momentum: <span class=arithmatex>\( p(t + \frac{\epsilon}{2}) = p(t) - \frac{\epsilon}{2} \frac{\partial U}{\partial q}(q(t)) \)</span></p> </li> <li>Full-step position: <span class=arithmatex>\( q(t + \epsilon) = q(t) + \epsilon \frac{\partial K}{\partial p}(p(t + \frac{\epsilon}{2})) \)</span>, where <span class=arithmatex>\( K(p) = \frac{1}{2} p^T M^{-1} p \)</span>, so <span class=arithmatex>\( \frac{\partial K}{\partial p} = M^{-1} p \)</span></li> <li>Full-step momentum: <span class=arithmatex>\( p(t + \epsilon) = p(t + \frac{\epsilon}{2}) - \frac{\epsilon}{2} \frac{\partial U}{\partial q}(q(t + \epsilon)) \)</span></li> </ol> <p>This is repeated L times to get proposed <span class=arithmatex>\( \dot{q} \)</span> and <span class=arithmatex>\( \dot{p} \)</span>.</p> <ol> <li><strong>Metropolis-Hastings Acceptance</strong>: Accept the proposed <span class=arithmatex>\( \dot{q} \)</span> with probability <span class=arithmatex>\( \min(1, e^{H(q_0,p_0) - H(\dot{q},\dot{p})}) \)</span>, where <span class=arithmatex>\( H(q,p) = U(q) + K(p) \)</span>.</li> </ol> <p>This process generates a Markov chain with stationary distribution <span class=arithmatex>\( P(q) \)</span>, leveraging Hamiltonian dynamics to take larger, more efficient steps compared to random-walk methods.</p> <details class=question> <summary>Why Better Than Random Walk?</summary> <p>HMC navigates high-dimensional spaces along energy contours - like following mountain paths instead of wandering randomly!</p> </details> <details class=info> <summary>Recap of the Hamilton's equations?</summary> <div class=arithmatex>\[ \begin{cases} \dot{q} = \nabla_p K(p) = M^{-1}p &amp; \text{(Guided exploration)} \\ \dot{p} = -\nabla_q U(q) = \nabla_q \log P(q) &amp; \text{(Bayesian updating)} \end{cases} \]</div> </details> <p>This coupled system drives <span class=arithmatex>\( (q,p) \)</span> along iso-probability contours of <span class=arithmatex>\( P(q) \)</span>, with momentum <strong>rotating</strong> rather than <strong>resetting</strong> at each step like in Random Walk Metropolis--think of following mountain paths instead of wandering randomly! The key parameters - integration time <span class=arithmatex>\( \tau = L\epsilon \)</span> and step size <span class=arithmatex>\( \epsilon \)</span> - balance exploration vs. computational cost: </p> <ul> <li><strong>Short <span class=arithmatex>\( \tau \)</span></strong>: Local exploration, higher acceptance </li> <li><strong>Long <span class=arithmatex>\( \tau \)</span></strong>: Global moves, risk of U-turns (periodic orbits) </li> </ul> <div class="admonition tip"> <p class=admonition-title>Key Parameters and Tuning</p> <p>Tuning <span class=arithmatex>\( M \)</span> to match the covariance of <span class=arithmatex>\( P(q) \)</span> (e.g., via warmup adaptation) and setting <span class=arithmatex>\( \tau \sim \mathcal{O}(1/\lambda_{\text{max}}) \)</span>, where <span class=arithmatex>\( \lambda_{\text{max}} \)</span> is the largest eigenvalue of <span class=arithmatex>\( \nabla^2 U \)</span>, often yields optimal mixing.</p> </div> <h3 id=connection-with-energy-based-models>Connection with Energy-Based Models<a class=headerlink href=#connection-with-energy-based-models title="Permanent link">&para;</a></h3> <p>Energy-based models (EBMs) are a class of generative models that define a probability distribution over data points using an energy function. The probability of a data point is proportional to <span class=arithmatex>\( e^{-E(x)} \)</span>, where <span class=arithmatex>\( E(x) \)</span> is the energy function. This formulation is directly analogous to the Boltzmann distribution in statistical physics, where the probability is related to the energy of a state. In Hamiltonian mechanics, the Hamiltonian function <span class=arithmatex>\( H(q, p) \)</span> represents the total energy of the system, and the probability distribution in phase space is given by <span class=arithmatex>\( e^{-H(q,p)/T} \)</span>, where <span class=arithmatex>\( T \)</span> is the temperature.</p> <p>In EBMs, Hamiltonian Monte Carlo (HMC) is often used to sample from the model's distribution. HMC leverages Hamiltonian dynamics to propose new states, which are then accepted or rejected based on the Metropolis-Hastings criterion. This method is particularly effective for high-dimensional problems, as it reduces the correlation between samples and allows for more efficient exploration of the state space. For instance, in image generation tasks, HMC can sample from the distribution defined by the energy function, facilitating the generation of high-quality images.</p> <p>EBMs define probability through Hamiltonians:</p> <div class=arithmatex>\[ p(x) = \frac{1}{Z}e^{-E(x)} \quad \leftrightarrow \quad H(q,p) = E(q) + K(p) \]</div> <h2 id=potential-research-directions><img alt=🔮 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f52e.svg title=:crystal_ball:> Potential Research Directions<a class=headerlink href=#potential-research-directions title="Permanent link">&para;</a></h2> <h3 id=symplecticity-in-machine-learning-models>Symplecticity in Machine Learning Models<a class=headerlink href=#symplecticity-in-machine-learning-models title="Permanent link">&para;</a></h3> <figure> <a class=glightbox href=https://greydanus.github.io/assets/hamiltonian-nns/overall-idea.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=https://greydanus.github.io/assets/hamiltonian-nns/overall-idea.png alt="Hamiltonian Neural Networks Overall Idea" width=95%></a> <figcaption>Overview of the Hamiltonian Neural Networks architecture. Image from the HNN paper.</figcaption> </figure> <p>Incorporate the symplectic structure of Hamiltonian mechanics into machine learning models to preserve properties like energy conservation, which is crucial for long-term predictions. Generalizing Hamiltonian Neural Networks (HNNs), as discussed in <a href=https://greydanus.github.io/2019/05/15/hamiltonian-nns/ >Hamiltonian Neural Networks</a>, to more complex systems or developing new architectures that preserve symplecticity</p> <h3 id=hmc-for-complex-distributions>HMC for Complex Distributions:<a class=headerlink href=#hmc-for-complex-distributions title="Permanent link">&para;</a></h3> <p>HMC for sampling from complex, high-dimensional, and multimodal distributions, such as those encountered in deep learning. Combining HMC with other techniques, like parallel tempering, could handle distributions with multiple modes more effectively.</p> <h3 id=combining-hamiltonian-mechanics-with-other-ml-techniques>Combining Hamiltonian Mechanics with Other ML Techniques:<a class=headerlink href=#combining-hamiltonian-mechanics-with-other-ml-techniques title="Permanent link">&para;</a></h3> <p>Integrate Hamiltonian mechanics with reinforcement learning to guide exploration in continuous state and action spaces. Using it to model the environment could improve exploration strategies, as seen in potential applications in robotics. Additionally, using Hamiltonian mechanics to define approximate posteriors in variational inference could lead to more flexible and accurate approximations. </p> <h3 id=hamiltonian-gans>Hamiltonian GANs<a class=headerlink href=#hamiltonian-gans title="Permanent link">&para;</a></h3> <p>Employing Hamiltonian formalism as an inductive bias for the generation of physically plausible videos with neural networks. Imagine generator-discriminator dynamics governed by:</p> <p>The possibilities make phase space feel infinite...</p> <h3 id=want-to-team-up-on-this><span style="color: orangered;">Want to Team Up on This</span> 🤓<a class=headerlink href=#want-to-team-up-on-this title="Permanent link">&para;</a></h3> <p>If you are an ML researcher and are interested in collaborating on researching EBMs, diffusion- and flow-based models, or have other relevant ideas in mind for generalization over out-of-distribution data (downstream tasks can be anything in from molecular design to robotics motion planning to LLMs), please feel free to reach out!</p> <p>Also follow me on <a href=https://twitter.com/soranghadri target=_blank><strong>Twitter</strong></a> / <a href=https://bsky.app/profile/soranghaderi.bsky.social target=_blank>BlueSky</a> or <a href=https://github.com/soran-ghaderi target=_blank><strong>GitHub</strong></a>—I’m usually rambling about this stuff there. Also on <a href=https://www.linkedin.com/in/soran-ghaderi target=_blank>LinkedIn</a> and <a href=https://soran-ghaderi.medium.com/ target=_blank>Medium</a> / <a href=https://towardsdatascience.com/author/soran-ghaderi/ target=_blank>TDS</a> if you’re curious. To find more about my research interests, check out my <a href=https://soran-ghaderi.github.io/ target=_blank><strong>personal website</strong></a>.</p> <hr> <h2 id=useful-links><img alt=📚 class=twemoji src=https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f4da.svg title=:books:> Useful Links<a class=headerlink href=#useful-links title="Permanent link">&para;</a></h2> <ul> <li><a href=https://lemesurierb.people.charleston.edu/numerical-methods-and-analysis-python/main/ODE-IVP-6-multi-step-methods-introduction-python.html>An Introduction to Multistep Methods: Leap-frog</a></li> <li><a href=https://bayesianbrad.github.io/posts/2019_hmc.html>The beginners guide to Hamiltonian Monte Carlo</a></li> <li><a href=https://bjlkeng.io/posts/hamiltonian-monte-carlo/ >Hamiltonian Monte Carlo</a></li> <li><a href=https://mc-stan.org/docs/2_19/reference-manual/hamiltonian-monte-carlo.html>Hamiltonian Monte Carlo - Stan</a> - Stan explained</li> <li><a href=https://profoundphysics.com/hamiltonian-mechanics-for-dummies/ >Hamiltonian Mechanics For Dummies: An Intuitive Introduction</a>.</li> <li><a href=https://en.wikipedia.org/wiki/Hamiltonian_mechanics>Hamiltonian mechanics Wikipedia page</a></li> <li><a href=https://www.macs.hw.ac.uk/~simonm/mechanics.pdf>An introduction to Lagrangian and Hamiltonian mechanics Lecture notes</a></li> <li> <p><a href=https://phys.libretexts.org/Bookshelves/Classical_Mechanics/Classical_Mechanics_%28Tatum%29/14:_Hamiltonian_Mechanics>Hamiltonian Mechanics - Jeremy Tatum, University of Victoria</a></p> </li> <li> <p><a href=https://greydanus.github.io/2019/05/15/hamiltonian-nns/ >Hamiltonian Neural Networks - Blog</a></p> </li> <li><a href=https://arxiv.org/abs/1906.01563>Hamiltonian Neural Networks</a></li> <li>Other: <a href=https://greydanus.github.io/ >Natural Intelligence - A blog by Sam Greydanus</a> - Many interesting topics </li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="April 1, 2025 20:06:25">April 1, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="March 10, 2025 17:46:23">March 10, 2025</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../langevin-dynamics-sampling/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Langevin dynamics sampling"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Langevin dynamics sampling </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.github.com/soran-ghaderi target=_blank rel=noopener title=www.github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg> </a> <a href=https://www.x.com/soranghadri target=_blank rel=noopener title=www.x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"/></svg> </a> <a href=https://www.linkedin.com/in/soran-ghaderi target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href=https://www.soran-ghaderi.github.io target=_blank rel=noopener title=www.soran-ghaderi.github.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.footer", "navigation.tabs", "navigation.indexes", "navigation.tabs.sticky", "navigation.instant", "navigation.top", "navigation.sections", "navigation.path", "navigation.tracking", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": false, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>